---
layout: post
title:  "About the OutlawCountry Linux malware"
date:   2017-06-30 12:32 +0200
tags:	[malware, linux, netfilter]
---

![netfilter_predator][netfilter_predator]

Today I noticed the internet buzz about a new alleged Linux malware called
*OutlawCountry* by the CIA, and [leaked by Wikileaks][leak].

The malware redirects traffic from the victim to a control server in order
to spy or whatever. To redirect this traffic, they use simple Netfilter NAT
rules injected in the kernel.

<!--more-->

According to many sites commenting on the issue, is seems that there is
something wrong with the Linux kernel Netfilter subsystem, but I read the
leaked docs, and what they do is to **load a custom kernel module** in order to
be able to load Netfilter NAT table/rules with more priority than the default
ones (overriding any config the system may have).

Isn't that clear? The attacker is loading a custom kernel module **as root**
in your machine. They don't use Netfilter to break into your system. The
problem is not Netfilter, the problem is your whole machine being under
their control.

With root control of the machine, they could simply use any mechanism,
like [kpatch][kpatch] or whatever, to replace your whole running kernel
with a new one, with full access to memory, networking, file system et al.

They probably use a rootkit or the like to take over the system.

[netfilter_predator]:	{{site.url}}/assets/netfilter_predator.png
[leak]:			https://wikileaks.org/vault7/#OutlawCountry
[kpatch]:		https://en.wikipedia.org/wiki/Kpatch
